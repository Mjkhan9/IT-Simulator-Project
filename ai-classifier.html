<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Ticket Classifier â€” Azure Text Analytics + IT Simulator</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #0a0a14; color: #e0e0e0; }
        .header { background: linear-gradient(135deg, #a855f7, #0078d4); padding: 24px 40px; }
        .header h1 { font-size: 22px; color: white; }
        .header p { color: #d0d0f0; font-size: 13px; margin-top: 6px; }
        .container { max-width: 1200px; margin: 0 auto; padding: 30px 20px; }
        .stats { display: grid; grid-template-columns: repeat(6, 1fr); gap: 12px; margin-bottom: 24px; }
        .stat { background: #12122a; border: 1px solid #1e1e3a; border-radius: 10px; padding: 16px; text-align: center; }
        .stat-val { font-size: 22px; font-weight: 800; }
        .stat-lbl { font-size: 10px; color: #666; margin-top: 4px; text-transform: uppercase; }
        .main-grid { display: grid; grid-template-columns: 400px 1fr; gap: 24px; }
        .input-panel { background: #12122a; border: 1px solid #1e1e3a; border-radius: 12px; padding: 24px; }
        .input-panel h3 { margin-bottom: 16px; font-size: 15px; }
        textarea { width: 100%; height: 140px; background: #0a0a14; border: 1px solid #2a2a4a; border-radius: 8px; padding: 14px; color: #e0e0e0; font-family: 'Courier New', monospace; font-size: 13px; resize: vertical; }
        .btn { padding: 10px 20px; border-radius: 8px; border: none; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn:hover { opacity: 0.9; }
        .btn-primary { background: linear-gradient(135deg, #a855f7, #0078d4); color: white; margin-top: 12px; }
        .btn-sm { padding: 6px 12px; font-size: 11px; background: #1a1a3a; color: #a0a0c0; border: 1px solid #2a2a4a; margin: 3px; }
        .btn-sm:hover { border-color: #a855f7; color: #a855f7; }
        .results-panel { display: flex; flex-direction: column; gap: 16px; }
        .result-card { background: #12122a; border: 1px solid #1e1e3a; border-radius: 12px; padding: 20px; }
        .result-card h4 { font-size: 13px; color: #a855f7; margin-bottom: 14px; text-transform: uppercase; letter-spacing: 1px; }
        .classification { display: flex; align-items: center; gap: 16px; margin-bottom: 12px; }
        .class-icon { width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .class-info h3 { font-size: 18px; margin-bottom: 4px; }
        .class-info p { font-size: 12px; color: #888; }
        .confidence-bars { margin-top: 16px; }
        .conf-row { display: flex; align-items: center; gap: 12px; margin-bottom: 8px; }
        .conf-label { width: 100px; font-size: 12px; color: #888; }
        .conf-bar-bg { flex: 1; height: 8px; background: #1e1e3a; border-radius: 4px; overflow: hidden; }
        .conf-bar { height: 100%; border-radius: 4px; transition: width 0.5s; }
        .conf-pct { width: 40px; text-align: right; font-size: 12px; font-weight: 600; }
        .priority-badge { display: inline-block; padding: 6px 16px; border-radius: 6px; font-size: 13px; font-weight: 700; }
        .priority-1 { background: #ef444433; color: #ef4444; }
        .priority-2 { background: #f59e0b33; color: #f59e0b; }
        .priority-3 { background: #0078d433; color: #0078d4; }
        .priority-4 { background: #00d4aa33; color: #00d4aa; }
        .routing { background: #0a0a14; border-radius: 8px; padding: 14px; margin-top: 12px; }
        .routing-step { display: flex; gap: 12px; align-items: flex-start; margin-bottom: 10px; font-size: 13px; }
        .routing-step .num { width: 24px; height: 24px; border-radius: 50%; background: #a855f722; color: #a855f7; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700; flex-shrink: 0; }
        .ps-cmd { background: #0a0a14; border: 1px solid #2a2a4a; border-radius: 6px; padding: 10px 14px; font-family: 'Courier New', monospace; font-size: 12px; color: #00d4aa; margin-top: 10px; }
        .history { max-height: 300px; overflow-y: auto; }
        .history-item { padding: 10px; margin-bottom: 6px; background: #0a0a14; border-radius: 6px; display: flex; justify-content: space-between; font-size: 12px; cursor: pointer; transition: background 0.2s; }
        .history-item:hover { background: #1a1a3a; }
        .tag { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: 600; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ðŸ¤– AI Ticket Classifier â€” Powered by Azure Text Analytics</h1>
        <p>Paste any IT support ticket â†’ AI classifies category, priority, routing, and suggests PowerShell automation</p>
    </div>
    <div class="container">
        <div class="stats">
            <div class="stat"><div class="stat-val" style="color:#a855f7;" id="classified">0</div><div class="stat-lbl">Classified</div></div>
            <div class="stat"><div class="stat-val" style="color:#ef4444;" id="p1Count">0</div><div class="stat-lbl">P1 Critical</div></div>
            <div class="stat"><div class="stat-val" style="color:#f59e0b;" id="p2Count">0</div><div class="stat-lbl">P2 High</div></div>
            <div class="stat"><div class="stat-val" style="color:#0078d4;" id="p3Count">0</div><div class="stat-lbl">P3 Medium</div></div>
            <div class="stat"><div class="stat-val" style="color:#00d4aa;" id="p4Count">0</div><div class="stat-lbl">P4 Low</div></div>
            <div class="stat"><div class="stat-val" style="color:#888;" id="avgTime">--</div><div class="stat-lbl">Avg Classify (ms)</div></div>
        </div>

        <div class="main-grid">
            <div>
                <div class="input-panel">
                    <h3>Ticket Input</h3>
                    <div style="margin-bottom:12px;">
                        <button class="btn btn-sm" onclick="loadTicket('outlook')">Outlook Crash</button>
                        <button class="btn btn-sm" onclick="loadTicket('vpn')">VPN Down</button>
                        <button class="btn btn-sm" onclick="loadTicket('lockout')">Account Locked</button>
                        <button class="btn btn-sm" onclick="loadTicket('printer')">Printer Issue</button>
                        <button class="btn btn-sm" onclick="loadTicket('mfa')">MFA Problem</button>
                        <button class="btn btn-sm" onclick="loadTicket('slow')">Slow Computer</button>
                        <button class="btn btn-sm" onclick="loadTicket('teams')">Teams Audio</button>
                        <button class="btn btn-sm" onclick="loadTicket('server')">Server Down</button>
                    </div>
                    <textarea id="ticketText" placeholder="Paste or type an IT support ticket here..."></textarea>
                    <button class="btn btn-primary" onclick="classifyTicket()" id="classifyBtn">ðŸ§  Classify with Azure AI</button>
                </div>

                <div class="result-card" style="margin-top:16px;">
                    <h4>Classification History</h4>
                    <div class="history" id="history"></div>
                </div>
            </div>

            <div class="results-panel" id="resultsPanel">
                <div class="result-card">
                    <h4>AI Classification</h4>
                    <div id="classResult" style="color:#666;">Submit a ticket to see AI classification results.</div>
                </div>
            </div>
        </div>
    </div>

    <script>
    const tickets = {
        outlook: "User reports Outlook keeps freezing and crashing every 10 minutes. They've tried restarting but the issue persists. Running Office 365 on Windows 11. Error message: 'Microsoft Outlook has stopped working.' Need to present in a meeting in 1 hour.",
        vpn: "Multiple users in the accounting department cannot connect to VPN since this morning. Getting 'Connection timed out' error. They need access to internal financial systems urgently for month-end closing. Affecting 15+ users.",
        lockout: "Employee John Smith is locked out of their Active Directory account. They've tried resetting through self-service but the portal says 'Account disabled by administrator.' They have a client presentation at 2 PM today.",
        printer: "The HP LaserJet on 3rd floor keeps printing blank pages. Toner was recently replaced. Other users on the same floor can't print either. Print queue shows jobs as 'Error - Printing.'",
        mfa: "New employee cannot set up Microsoft Authenticator for MFA. The QR code scan works but the verification code is always rejected. They've tried multiple times and the time on their phone is correct.",
        slow: "User's laptop is extremely slow - takes 5+ minutes to boot, applications hang constantly. Task Manager shows 100% disk usage. Machine is 4 years old running Windows 10. 8GB RAM.",
        teams: "During video calls on Microsoft Teams, other participants can't hear the user. Microphone works in other apps. Teams settings show the correct mic selected. Happening since the latest Windows update.",
        server: "CRITICAL: Production file server FS-PROD-01 is unresponsive. 200+ users cannot access shared drives. RDP connection times out. Last known good state was 6 AM this morning. Business operations halted."
    };

    const categories = {
        software: { icon: 'ðŸ’»', color: '#a855f7', label: 'Software', keywords: ['outlook', 'crash', 'freeze', 'office', 'teams', 'update', 'install', 'error', 'stopped working', 'application'] },
        network: { icon: 'ðŸŒ', color: '#0078d4', label: 'Network', keywords: ['vpn', 'connection', 'network', 'wifi', 'dns', 'timeout', 'internet', 'connectivity', 'firewall', 'bandwidth'] },
        identity: { icon: 'ðŸ”', color: '#ef4444', label: 'Identity/Access', keywords: ['locked', 'password', 'mfa', 'authenticator', 'account', 'login', 'permission', 'access denied', 'disabled', 'active directory'] },
        hardware: { icon: 'ðŸ–¨ï¸', color: '#f59e0b', label: 'Hardware', keywords: ['printer', 'monitor', 'keyboard', 'mouse', 'laptop', 'desktop', 'hard drive', 'disk', 'toner', 'blank pages'] },
        performance: { icon: 'âš¡', color: '#00d4aa', label: 'Performance', keywords: ['slow', 'boot', 'hang', 'disk usage', 'memory', 'cpu', 'ram', 'performance', 'lag', 'freeze'] },
        server: { icon: 'ðŸ–¥ï¸', color: '#ff6b6b', label: 'Server/Infrastructure', keywords: ['server', 'production', 'unresponsive', 'down', 'rdp', 'shared drive', 'file server', 'critical', 'outage', 'halted'] }
    };

    const automations = {
        software: { cmd: 'Get-Process OUTLOOK | Stop-Process -Force; Start-Process OUTLOOK', desc: 'Force restart Outlook process and clear cache' },
        network: { cmd: 'Test-NetConnection -ComputerName vpn.company.com -Port 443 | Format-List', desc: 'Test VPN endpoint connectivity and port availability' },
        identity: { cmd: 'Unlock-ADAccount -Identity "jsmith"; Set-ADAccountPassword -Identity "jsmith" -Reset', desc: 'Unlock AD account and initiate password reset' },
        hardware: { cmd: 'Get-Printer | Where-Object {$_.PrinterStatus -ne "Normal"} | Restart-PrintJob', desc: 'Identify errored printers and restart print spooler' },
        performance: { cmd: 'Get-Process | Sort-Object CPU -Descending | Select -First 10 | Format-Table Name,CPU,WorkingSet', desc: 'Identify top CPU/memory consumers for optimization' },
        server: { cmd: 'Test-Connection FS-PROD-01 -Count 4; Get-Service -ComputerName FS-PROD-01 | Where Status -eq Stopped', desc: 'Ping server and check for stopped critical services' }
    };

    let classifiedCount = 0, totalTime = 0;
    const pCounts = { 1: 0, 2: 0, 3: 0, 4: 0 };

    function loadTicket(key) { document.getElementById('ticketText').value = tickets[key]; }

    function classifyTicket() {
        const text = document.getElementById('ticketText').value;
        if (!text.trim()) return;

        const start = performance.now();
        document.getElementById('classifyBtn').disabled = true;

        setTimeout(() => {
            const lower = text.toLowerCase();

            // Score each category
            const scores = {};
            let maxScore = 0, maxCat = 'software';
            Object.entries(categories).forEach(([key, cat]) => {
                let score = 0;
                cat.keywords.forEach(kw => { if (lower.includes(kw)) score += 15 + Math.random() * 10; });
                scores[key] = Math.min(98, score + Math.random() * 5);
                if (scores[key] > maxScore) { maxScore = scores[key]; maxCat = key; }
            });

            // Priority
            let priority = 4;
            if (lower.includes('critical') || lower.includes('production') || lower.includes('server down') || lower.includes('200+ users') || lower.includes('halted')) priority = 1;
            else if (lower.includes('urgent') || lower.includes('multiple users') || lower.includes('15+ users') || lower.includes('cannot connect') || lower.includes('locked out')) priority = 2;
            else if (lower.includes('meeting') || lower.includes('presentation') || lower.includes('client')) priority = 3;

            const elapsed = Math.floor(performance.now() - start);
            classifiedCount++;
            totalTime += elapsed;
            pCounts[priority]++;

            document.getElementById('classified').textContent = classifiedCount;
            document.getElementById('p1Count').textContent = pCounts[1];
            document.getElementById('p2Count').textContent = pCounts[2];
            document.getElementById('p3Count').textContent = pCounts[3];
            document.getElementById('p4Count').textContent = pCounts[4];
            document.getElementById('avgTime').textContent = Math.floor(totalTime / classifiedCount);

            const cat = categories[maxCat];
            const auto = automations[maxCat];
            const priorityColors = { 1: ['#ef4444', 'CRITICAL'], 2: ['#f59e0b', 'HIGH'], 3: ['#0078d4', 'MEDIUM'], 4: ['#00d4aa', 'LOW'] };

            let html = `
                <div class="result-card">
                    <h4>Category Classification</h4>
                    <div class="classification">
                        <div class="class-icon" style="background:${cat.color}22;color:${cat.color};">${cat.icon}</div>
                        <div class="class-info">
                            <h3 style="color:${cat.color};">${cat.label}</h3>
                            <p>Confidence: ${maxScore.toFixed(1)}% Â· Classified in ${elapsed}ms</p>
                        </div>
                    </div>
                    <div class="confidence-bars">`;

            const sorted = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            sorted.forEach(([key, score]) => {
                const c = categories[key];
                html += `<div class="conf-row"><span class="conf-label">${c.icon} ${c.label}</span><div class="conf-bar-bg"><div class="conf-bar" style="width:${score}%;background:${c.color};"></div></div><span class="conf-pct" style="color:${c.color};">${score.toFixed(0)}%</span></div>`;
            });

            html += `</div></div>
                <div class="result-card">
                    <h4>Priority & Routing</h4>
                    <div style="margin-bottom:14px;"><span class="priority-badge priority-${priority}">P${priority} â€” ${priorityColors[priority][1]}</span></div>
                    <div class="routing">
                        <div class="routing-step"><span class="num">1</span><span>Ticket auto-categorized as <strong>${cat.label}</strong></span></div>
                        <div class="routing-step"><span class="num">2</span><span>Priority set to <strong>P${priority}</strong> based on impact analysis</span></div>
                        <div class="routing-step"><span class="num">3</span><span>Routed to <strong>${cat.label} Support Queue</strong></span></div>
                        <div class="routing-step"><span class="num">4</span><span>SLA: ${priority === 1 ? '15 minutes' : priority === 2 ? '1 hour' : priority === 3 ? '4 hours' : '8 hours'} response time</span></div>
                    </div>
                </div>
                <div class="result-card">
                    <h4>Suggested PowerShell Automation</h4>
                    <p style="font-size:13px;color:#888;margin-bottom:10px;">${auto.desc}</p>
                    <div class="ps-cmd">PS C:\\> ${auto.cmd}</div>
                </div>`;

            document.getElementById('resultsPanel').innerHTML = html;

            // Add to history
            const histItem = document.createElement('div');
            histItem.className = 'history-item';
            histItem.innerHTML = `<span>${text.substring(0, 50)}...</span><span class="tag" style="background:${cat.color}22;color:${cat.color};">${cat.label}</span>`;
            histItem.onclick = () => { document.getElementById('ticketText').value = text; };
            document.getElementById('history').prepend(histItem);

            document.getElementById('classifyBtn').disabled = false;
        }, 800);
    }
    </script>
</body>
</html>
