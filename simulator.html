<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ticket Simulator - ITAS</title>
    <link rel="stylesheet" href="css/fluent-core.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/simulator.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' rx='6' fill='%2300d4aa'/%3E%3Cpath d='M16 8L8 12V16C8 20.4183 11.5817 24 16 24C20.4183 24 24 20.4183 24 16V12L16 8Z' fill='%230a0a0f'/%3E%3C/svg%3E">
</head>
<body>
    <!-- NAVBAR -->
    <header class="navbar">
        <div class="nav-left">
            <div class="logo">
                <svg width="24" height="24" viewBox="0 0 32 32" fill="none">
                    <path d="M16 8L8 12V16C8 20.4183 11.5817 24 16 24C20.4183 24 24 20.4183 24 16V12L16 8Z" fill="#0a0a0f"/>
                    <circle cx="16" cy="16" r="3" fill="#00d4aa"/>
                </svg>
            </div>
            <div>
                <span class="brand">ITAS</span>
                <div class="brand-subtitle">IT Automation Simulator</div>
            </div>
        </div>
        <nav class="nav-right">
            <a href="index.html">Home</a>
            <a href="simulator.html" class="active">Simulator</a>
            <a href="scripts.html">Scripts</a>
            <a href="kb.html">Knowledge Base</a>
            <a href="labs.html">IT Labs</a>
        </nav>
    </header>

    <!-- SIMULATOR CONTAINER -->
    <div class="simulator-container">
        <!-- SIDEBAR -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <button class="sidebar-toggle" id="sidebarToggle" onclick="toggleSidebar()">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M3 5h14M3 10h14M3 15h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section-title">Ticket Management</div>
                <a href="#" class="nav-item active" onclick="showSection('ticket')">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="3" y="3" width="14" height="14" rx="2" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M6 7h8M6 10h5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>Active Ticket</span>
                </a>
                <a href="#" class="nav-item" onclick="showSection('diagnostics')">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <circle cx="10" cy="10" r="7" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M10 6v4l2 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>Diagnostics</span>
                </a>
                
                <div class="nav-section-title">Automation</div>
                <a href="#" class="nav-item" onclick="showSection('automation')">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M7 4l-3 3 3 3M13 4l3 3-3 3M11 2L9 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>Workflows</span>
                </a>
                <a href="#" class="nav-item" onclick="showSection('logs')">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="4" y="4" width="12" height="12" rx="1" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M7 8h6M7 11h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>Event Logs</span>
                </a>
                
                <div class="nav-section-title">Resolution</div>
                <a href="#" class="nav-item" onclick="showSection('resolution')">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M10 2L4 6v6c0 3.5 2.5 6.5 6 8 3.5-1.5 6-4.5 6-8V6l-6-4z" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M7 10l2 2 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>Resolution</span>
                </a>
            </nav>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <!-- METRICS DASHBOARD -->
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-icon" style="background: var(--accent-muted);">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <rect x="3" y="3" width="18" height="18" rx="2" stroke="var(--accent)" stroke-width="2"/>
                            <path d="M8 10h8M8 14h5" stroke="var(--accent)" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="metric-content">
                        <div class="metric-value" id="ticketsToday">12</div>
                        <div class="metric-label">Tickets Today</div>
                    </div>
                    <span class="metric-change positive">+15%</span>
                </div>
                <div class="metric-card">
                    <div class="metric-icon" style="background: var(--success-bg);">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <circle cx="12" cy="12" r="9" stroke="var(--success)" stroke-width="2"/>
                            <path d="M9 12l2 2 4-4" stroke="var(--success)" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="metric-content">
                        <div class="metric-value" id="resolvedToday">9</div>
                        <div class="metric-label">Resolved</div>
                    </div>
                    <span class="metric-change positive">+8%</span>
                </div>
                <div class="metric-card">
                    <div class="metric-icon" style="background: var(--warning-bg);">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <circle cx="12" cy="12" r="9" stroke="var(--warning)" stroke-width="2"/>
                            <path d="M12 8v4M12 16h.01" stroke="var(--warning)" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="metric-content">
                        <div class="metric-value" id="pendingTickets">3</div>
                        <div class="metric-label">Pending</div>
                    </div>
                </div>
                <div class="metric-card">
                    <div class="metric-icon" style="background: var(--accent-secondary-muted);">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <circle cx="12" cy="12" r="9" stroke="var(--accent-secondary)" stroke-width="2"/>
                            <path d="M12 7v5l3 3" stroke="var(--accent-secondary)" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="metric-content">
                        <div class="metric-value">14m</div>
                        <div class="metric-label">Avg Resolution</div>
                    </div>
                    <span class="metric-change negative">-3m</span>
                </div>
            </div>

            <!-- TICKET PANEL -->
            <div class="ticket-panel" id="ticketPanel">
                <div class="panel-header">
                    <div>
                        <h2>Ticket #INC-2024-11547</h2>
                        <div class="panel-header-meta">
                            <span class="badge" style="background: rgba(0,0,0,0.2); color: #0a0a0f;">High Priority</span>
                            <span class="badge" style="background: rgba(0,0,0,0.2); color: #0a0a0f;">Software</span>
                        </div>
                    </div>
                    <button class="ghost-btn" onclick="generateNewTicket()" style="background: rgba(0,0,0,0.2); border-color: rgba(0,0,0,0.3); color: #0a0a0f;">
                        <svg width="18" height="18" viewBox="0 0 18 18" fill="none" style="margin-right: 8px;">
                            <path d="M14 4L4 14M4 4l10 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" transform="rotate(45 9 9)"/>
                        </svg>
                        New Ticket
                    </button>
                </div>
                <div class="panel-body">
                    <div class="ticket-info-grid">
                        <div class="info-item">
                            <span class="info-label">User</span>
                            <span class="info-value" id="ticketUser">Sarah Johnson</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Device</span>
                            <span class="info-value" id="ticketDevice">LAPTOP-NYC-2847</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Operating System</span>
                            <span class="info-value" id="ticketOS">Windows 11 Pro (22H2)</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Category</span>
                            <span class="info-value" id="ticketCategory">Software - Microsoft Office</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Priority</span>
                            <span class="info-value" id="ticketPriority">High</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Status</span>
                            <span class="info-value" id="ticketStatus">
                                <span class="status-indicator" style="margin-right: 8px;"></span>
                                Open
                            </span>
                        </div>
                    </div>

                    <div style="margin-top: 24px;">
                        <h3 style="font-size: 1rem; font-weight: 600; margin-bottom: 12px; color: var(--text-primary); display: flex; align-items: center; gap: 8px;">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <circle cx="9" cy="9" r="7" stroke="var(--accent)" stroke-width="1.5"/>
                                <path d="M9 5v4M9 12h.01" stroke="var(--accent)" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Issue Description
                        </h3>
                        <div style="background: var(--bg-tertiary); padding: 18px; border-radius: var(--radius-md); border-left: 4px solid var(--accent); border: 1px solid var(--border);">
                            <p id="ticketDescription" style="color: var(--text-secondary); line-height: 1.7; margin: 0;">
                                Microsoft Outlook is not launching. When user clicks the Outlook icon, the application briefly appears in the task manager but then immediately closes. User has tried restarting the computer multiple times with no success. This is impacting user's ability to access email and calendar.
                            </p>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="primary-btn" onclick="startAutomation()">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <circle cx="9" cy="9" r="7" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M6 9l2 2 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Start Automation
                        </button>
                        <button class="secondary-btn" onclick="openDiagnostics()">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <circle cx="9" cy="9" r="7" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M9 5v4l2 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Run Diagnostics
                        </button>
                        <button class="accent-btn" onclick="openScriptLibrary()">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <path d="M6 4l-2 2 2 2M12 4l2 2-2 2M10 2L8 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            View Scripts
                        </button>
                        <button class="ghost-btn" onclick="viewLogs()">
                            Event Logs
                        </button>
                        <button class="primary-btn" onclick="generateResolution()" style="background: linear-gradient(135deg, var(--success) 0%, #059669 100%);">
                            Generate Resolution
                        </button>
                    </div>
                </div>
            </div>

            <!-- WORKFLOW SECTION -->
            <div class="workflow-container" id="workflowContainer" style="display: none;">
                <div class="panel-header">
                    <h2>Automated Troubleshooting Workflow</h2>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span class="status-indicator"></span>
                        <span style="font-size: 0.9rem;">Running</span>
                    </div>
                </div>
                <div class="workflow-canvas" id="workflowCanvas">
                    <!-- Workflow steps will be generated here -->
                </div>
            </div>
        </main>
    </div>

    <!-- DIAGNOSTICS DRAWER -->
    <div class="drawer" id="diagnosticsDrawer">
        <div class="drawer-header">
            <h2>System Diagnostics</h2>
            <button class="drawer-close" onclick="closeDrawer('diagnosticsDrawer')">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M6 6l8 8M14 6l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
        <div class="drawer-body" id="diagnosticsContent">
            <!-- Diagnostics content will be loaded here -->
        </div>
    </div>

    <!-- SCRIPTS DRAWER -->
    <div class="drawer" id="scriptsDrawer">
        <div class="drawer-header">
            <h2>PowerShell Scripts</h2>
            <button class="drawer-close" onclick="closeDrawer('scriptsDrawer')">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M6 6l8 8M14 6l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
        <div class="drawer-body" id="scriptsContent">
            <!-- Scripts content will be loaded here -->
        </div>
    </div>

    <script src="js/ticketEngine.js"></script>
    <script src="js/flowEngine.js"></script>
</body>
</html>
